generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model User {
  id        Int    @id @default(autoincrement())
  hash      String @unique
  firstName String
  lastName  String
  bets      Bet[]
  balance   Int    @default(50)
}

enum Result {
  PENDING
  UNDER
  OVER
}

model Pool {
  id        Int     @id @default(autoincrement())
  desc      String  @unique
  point     Decimal
  bets      Bet[]
  underPool Int     @default(0)
  overPool  Int     @default(0)
  result    Result  @default(PENDING)
}

model Bet {
  id       Int    @id @default(autoincrement())
  pool     Pool   @relation(fields: [poolID], references: [id], onDelete: Cascade)
  poolID   Int
  better   User   @relation(fields: [betterID], references: [id], onDelete: Cascade)
  betterID Int
  bet      Result
  amount   Int

  @@unique([betterID, poolID])
  @@index([poolID])
  @@index([betterID])
}
